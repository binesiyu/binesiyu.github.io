<!DOCTYPE html>













<html class="theme-next gemini" lang="">
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=6.7.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.7.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.7.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.7.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.7.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.7.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="未来视">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="未来视">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="未来视">






  <link rel="canonical" href="http://yoursite.com/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>未来视</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">未来视</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/04/借/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yu Bin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="未来视">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/06/04/借/" class="post-title-link" itemprop="url">借</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-06-04 10:13:02 / Modified: 10:19:55" itemprop="dateCreated datePublished" datetime="2019-06-04T10:13:02+08:00">2019-06-04</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/感悟/" itemprop="url" rel="index"><span itemprop="name">感悟</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>成功，不要“尽力”，要“借力”！</p>
</blockquote>
<h1 id="每个人都喜欢成功，却又时常感觉自己力不从心。相信每个人都有同感。"><a href="#每个人都喜欢成功，却又时常感觉自己力不从心。相信每个人都有同感。" class="headerlink" title="每个人都喜欢成功，却又时常感觉自己力不从心。相信每个人都有同感。"></a>每个人都喜欢成功，却又时常感觉自己力不从心。相信每个人都有同感。</h1><h2 id="一"><a href="#一" class="headerlink" title="一"></a>一</h2><p>　　一个小男孩在院子里搬一块石头，父亲在旁边鼓励：“孩子，只要你全力以赴，一定搬得起来！”但是石头太重，最终孩子也没能搬起来。他告诉父亲：“石头太重，我已经用尽全力了！”父亲说：“你没有用尽全力。”小男孩不解，父亲微笑着说：“因为我在你旁边，你都没有请求我的帮助！”<br>　　很多时候，我们就是那个小男孩。判断一件事情能不能做到，往往是看自己的能力够不够。其实一件事情结果的达成，谁又规定只能用自己的能力呢？很多成功者并不是他的能力有多强，而是他能整合更多的资源。我们也把这个叫“借力”。</p>
<h2 id="二"><a href="#二" class="headerlink" title="二"></a>二</h2><pre><code>谁说借力只能面向“我的同事、我的朋友、我的亲人”，有时候你的竞争对手也是很好的借力对象。突破“我”的局限，世界才会更宽广。
</code></pre><p>　　三国时候的诸葛亮是“借力”用得最好的人之一。<br>　　有一天，周瑜对诸葛亮说：“你3天之内，给我打造10万支箭来。”这是根本不可能完成的任务，诸葛亮还是满口答应。为什么？打造不出可以借嘛！他跟曹操说“我想杀你，借我10万支箭好吗？”你肯定会说曹操除非脑子进水了才会答应。<br>　　曹操脑子没进水，他真的借给诸葛亮10万支箭。在一个大雾蒙蒙的早上，诸葛亮派出几千艘木船，船上扎满了稻草，佯装攻打曹营的样子。曹操一看诸葛亮你真的要杀我呀，我先用箭射死你，命令所有的弓箭手万箭齐发，结果箭一支支射到了船的稻草上。不到一个时辰，诸葛亮就收到曹操送来的10多万支箭。这就是历史上著名的“草船借箭”的故事。<br>　　谁说借力只能面向“我的同事、我的朋友、我的亲人”，有时候你的竞争对手也是很好的借力对象。突破“我”的局限，世界才会更宽广。</p>
<h2 id="三"><a href="#三" class="headerlink" title="三"></a>三</h2><p>　　讲一个国外的故事。<br>　　英国大英图书馆，是世界上著名的图书馆，里面的藏书非常丰富。有一次，图书馆要搬家，也就是说从旧馆要搬到新馆去，结果一算，搬运费要几百万，根本就没有这么多钱。怎么办？有人给馆长出了个注意。<br>　　图书馆在报上登了一个广告：从即日开始，每个市民可以免费从大英图书馆借10本书。结果，许多市民蜂拥而至，没几天，就把图书馆的书借光了。书借出去了，怎么还呢？大家给我还到新馆来。就这样，图书馆借用大家的力量搬了一次家。<br>　　你肯定也想像大英图书馆那样“四两拨千斤”。如果你能发现自己的“四两之力”（图书），并且敢于把“四两之力”用出去（免费借阅），一切就都不是问题。给予，有时也是一种借力。<br>　　借力不仅是一种能力，也是一种勇气，更是一种智慧。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>   学会借力，你会获得不一样的成长，遇见不一样的世界，成就不一样的人生。借別人的力，借工具的力，借平台的力，借系统的力！由此，你便找到了杠杆的着力点，去撬动整个世界！</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/16/tolua实现分析/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yu Bin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="未来视">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/04/16/tolua实现分析/" class="post-title-link" itemprop="url">tolua实现分析</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-04-16 17:17:03 / Modified: 17:44:14" itemprop="dateCreated datePublished" datetime="2019-04-16T17:17:03+08:00">2019-04-16</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/lua/" itemprop="url" rel="index"><span itemprop="name">lua</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="tolua-如何将c-对象导入到lua里"><a href="#tolua-如何将c-对象导入到lua里" class="headerlink" title="tolua++如何将c++对象导入到lua里"></a>tolua++如何将c++对象导入到lua里</h2><p>tolua++为每一个传入lua的对象建立一个userdata，userdata的值，是c++对象的地址。userdata的metatable，是一个tolua++建立的，记录了userdata对应c++类型信息的表格，包括导出的成员变量、成员函数等信息。</p>
<p>对于成员变量的读取赋值，tolua++是在metatable里新建了.get和.set两个表。两个表里分别存储了以变量名为键，以读取设置c函数为值的表项。在metatable的<strong>index和</strong>newindex里，以变量名为键，从.get和.set表里取得读取设置函数并调用。</p>
<p>对于成员函数的调用，只需要以函数名为键，函数为值，存储在metatable里就好了。</p>
<p>传入c++对象的tolua++函数是tolua_pushusertype。一般情况下，第一次使用这个函数将一个c++对象push到lua堆栈上时，才会新建userdata。tolua++会以c++对象地址为键，userdata为值，将键值对存储在tolua_ubox表里。下次推入同样的c++对象时，从这个表里取出userdata推入堆栈即可。</p>
<h2 id="tolua-如何处理类型的继承"><a href="#tolua-如何处理类型的继承" class="headerlink" title="tolua++如何处理类型的继承"></a>tolua++如何处理类型的继承</h2><p>父类的metatable,是子类metatable的metatable。这样调用父类方法时，就会去父类的metatable里查找了。tolua_ubox 用来存储以C++对象指针为键, 值为lua建立的fulluserdata的键值对. 看tolua++源码中有两套ubox, 一套在全局注册表, 一套在C++类型的metatable中, 实际在看代码的过程中, 只用其中一套就OK, 先判断在C++类型的metatable中是否有ubox, 没有再建立全局注册表的ubox, 而在注册C++类型的metatable中就会在该metatable中建立ubox. 优先使用C++类型的metatable的ubox. ubox为值为弱引用的弱表.</p>
<p>tolua++还维护了一个tolua_super表，这个表以c++类型的metatable为键，以一个表格为值。这个值表格以类型名称为键，以true为值，记录了metatable对应c++类型的父类有哪些。这个表格可以用来帮助判断对象是否是某一个类型（子类实例也可以认为是父类类型）</p>
<h2 id="tolua-如何管理对象的生命周期"><a href="#tolua-如何管理对象的生命周期" class="headerlink" title="tolua++如何管理对象的生命周期"></a>tolua++如何管理对象的生命周期</h2><p>一般情况下，当lua里对c++对象的引用变量可以被垃圾回收时，tolua++只是简单的释放userdata占用的4字节指针地址内存。但是也可以通过绑定或者代码指定的方式，让tolua++真正释放对象所占内存。</p>
<p>绑定的方式，是指在将c++类型构造函数使用tolua++导出到lua里时，tolua++会自动生成new_local方法。如果在lua代码里，用这个方法新建对象时，tolua++会调用tolua_register_gc方法，指明回收对象时回收对象内存。</p>
<p>在c++代码里，使用tolua_pushusertype_and_takeownership；在lua代码里，使用tolua.takeownership，都可以达到同样的目的。</p>
<p>对于这些指定由tolua++回收内存的对象，如果其类型的析构函数也通过tolua++导出了，则在回收内存时，会通过delete运算符，调用对象的析构函数。否则只会使用free方法回收。</p>
<p>tolua_register_gc方法，做的事情，是以对象指针为键，以对象metatable为值，将键值对存储在tolua_gc表里。tolua_gc 用来标识是否由lua来进行垃圾回收的表. 以C++对象指针为键, 值为传入C++类型的metatable, 传入C++类型只能为C++对象的同类或者父类, 如果传入的是父类类型, gc的时候只会调用父类的析构</p>
<h2 id="tolua-自定义属性"><a href="#tolua-自定义属性" class="headerlink" title="tolua++自定义属性"></a>tolua++自定义属性</h2><p>有的时候，在lua里取得一个c++对象后，我们想赋给它一些只在lua环境下有意义的属性。或者，我们想在lua里扩展一个c++类。tolua++也提供了实现这种需求的机制。</p>
<p>tolua++在LUA_REGISTRY里维护了一张tolua_peers表用来存储C++对象在lua中的扩展, 键为弱引用的弱表。这张表以表示c++对象的userdata为键，以一张表格t为值。lua5.1没用到这张表, 直接通过对C++对象指针进行lua_setfenv环境变量设置和获取该C++对象的tolua_peers表</p>
<h2 id="tolua-注册类"><a href="#tolua-注册类" class="headerlink" title="tolua++注册类"></a>tolua++注册类</h2><ul>
<li>在项目文件中tolua++自动生成的绑定文件中的tolua_xxx_open(L)函数注册类绑定(其中xxx为pkg文件名)</li>
<li><code>tolua_xxx_open(L)</code>函数调用了<code>tolua_open(L)</code>, <code>tolua_reg_types</code>, <code>tolua_cclass</code>, <code>tolua_beginmodule</code>, <code>tolua_function</code>, <code>tolua_variable</code>, <code>tolua_endmodule</code>等函数进行类的绑定, 其中<code>tolua_reg_types</code>是自动绑定文件生成的函数, 其他都是tolua++库函数</li>
<li><code>tolua_open(L)</code>建立相应的全局注册表, 包括<code>tolua_opened</code>, <code>tolua_peers</code>, <code>tolua_ubox</code>, <code>tolua_super</code>, <code>tolua_gc</code></li>
<li><code>tolua_reg_types</code>主要调用<code>tolua_usertype</code>注册该pkg文件下的所有C++类型的metatabl</li>
<li><code>tolua_usertype</code>调用<code>tolua_newmetatable</code> 注册C++类型metatable和const C++类型metatable</li>
<li><code>tolua_usertype</code>调用<code>tolua_classevents</code>注册C++类型metatable中的<strong>add, </strong>call, <strong>div, </strong>eq, <strong>gc, </strong>index, <strong>le, </strong>lt, <strong>mul, </strong>newindex, __sub方法</li>
<li><code>tolua_cclass</code>设置父子关系, 以及对象回收函数(为tolua++自动生成的一个调用delete的C函数)</li>
<li><code>tolua_cclass</code>调用mapinheritance设置父子关系metatable, 指定父类为子类的metatable, 通过指定metatable的方式进行继承, 其中const_type—继承—&gt;type—继承—&gt;base_type</li>
<li><code>tolua_cclass</code>调用set_ubox设置父子关系共享同一tolua_ubox, tolua_ubox暂时为空表, 且值为弱引用的弱表</li>
<li><code>tolua_cclass</code>调用mapsuper设置全局注册表中tolua_super表的父子关系</li>
<li>绑定类成员函数: <code>tolua_function</code></li>
<li>绑定类成员变量: <code>tolua_variable</code>, 成员变量的绑定通过建立.set 和.get两张表, 通过<strong>index绑定tolua++生成的get方法, </strong>newindex绑定tolua++绑定的set方法</li>
<li>如果有namespace的话, 通过<code>tolua_beginmodule</code>和<code>tolua_endmodule</code>进行定义</li>
<li>绑定<code>new</code>, 通过绑定函数创建的对象, lua不会自动调用析构, 得手动调用delete进行析构</li>
<li>绑定<code>new_local</code>, 通过绑定的函数创建对象, 该函数中比new的绑定函数多了一个<code>lua_register_gc</code>调用, 在全局注册表中的<code>tolua_gc</code>表中, 以C++指针为键, 类型的metatable为值, 通过<code>class_gc_event</code>进行自动释放</li>
<li>绑定<code>delete</code>, 如果有析构函数的一定要注册析构函数, 否则释放时会调用默认的释放函数, <code>tolua_default_collect</code>, 调用free进行释放, 会发生很多未定义的行为</li>
</ul>
<h2 id="cocos2dx对tolua-绑定的修正"><a href="#cocos2dx对tolua-绑定的修正" class="headerlink" title="cocos2dx对tolua++绑定的修正"></a>cocos2dx对tolua++绑定的修正</h2><h3 id="c对lua回调函数的引用"><a href="#c对lua回调函数的引用" class="headerlink" title="c对lua回调函数的引用"></a>c对lua回调函数的引用</h3><p>在使用cocos2dx编写游戏时，我们经常会设置一些回调函数（时钟、菜单选择等）。如果采用脚本方式编写游戏的话，这些回调函数也是需要写在脚本里的。实现这个功能，就需要lua将自己的函数传递给c++，c++保持对这个函数的引用，不要让这个lua函数被垃圾回收，并在适当的时候回调这个lua函数。 这种需求的一般抽象是在C环境下保存lua状态，在PIL(Programming In Lua)里有比较详尽的描述。可以使用<code>luaL_ref</code>函数，将一个luaValue(function、table等没有直接对应c类型的数据)存储到LUA_REGISTRY里（luaL_ref返回一个唯一整数，c++可以用这个整数来索引对应的luaValue）,不过cocos2dx因为某种原因，并没有使用这个功能，而是自己实现了一套类似的引用机制。 cocos2dx注册回调函数的接口，除了一个参数为c函数指针的版本外，都会提供一个参数为int的对应版本。阅读一下自动生成的cocos2dx lua绑定代码，会发现注册回调函数的接口，都会调用toluafix_ref_function函数，将lua函数转换为一个LUA_FUNCTION（int），并调用响应的注册回调函数的cocos2dx api。 这个<code>toluafix_ref_function</code>，定义在tolua_fix.c里，干的事情就很类似luaL_ref了。区别是对lua函数的引用，没有直接保存在LUA_REGISTRY里，而是放在一个自己创建的表格里。</p>
<h3 id="B-野指针预防"><a href="#B-野指针预防" class="headerlink" title="B.野指针预防"></a>B.野指针预防</h3><p>使用已经释放的指针，通常是一个令人头疼的bug来源。如果能提早发现对野指针的使用，对于bug的定位有很大好处。tolua_fix.c里也提供了这样一套检查机制。<br>阅读自动生成的cocos2dx lua绑定代码，会发现每当把一个继承自CCObject类型的对象传给lua时，会调用<code>toluafix_pushusertype_ccobject</code>函数。<br>如果这个对象是第一次传递给lua，<code>toluafix_pushusertype_ccobject</code>会为这个对象生成一个索引id，并将这个对象的指针、类型字符串和这个索引相关联。cocos2dx再将这个索引存储在CCObject数据结构里。<br>在c++里析构这个对象时，CCObject的析构函数会调用<code>toluafix_remove_ccobject_by_refid</code>。这个函数先利用整数索引，找到指针、类型字符串，再通过tolua的tolua_ubox表格（见tolua++实现分析），取到对象的userdata（值为对象的地址），将它置空。这样，以后lua环境再使用这个对象，调用这个对象的c接口时，只能取到空地址，错误也能提早发现了。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://blog.csdn.net/haihsl123456789/article/details/40922595" target="_blank" rel="noopener">tolua++实现分析</a><br><a href="https://github.com/zfengzhen/Blog/blob/master/article/tolua%2B%2B%E5%AE%9E%E7%8E%B0%E5%88%86%E6%9E%90.md" target="_blank" rel="noopener">tolua++实现分析</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/15/macnvim/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yu Bin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="未来视">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/04/15/macnvim/" class="post-title-link" itemprop="url">macnvim</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-04-15 14:44:36 / Modified: 15:42:57" itemprop="dateCreated datePublished" datetime="2019-04-15T14:44:36+08:00">2019-04-15</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/vim/" itemprop="url" rel="index"><span itemprop="name">vim</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="畅想"><a href="#畅想" class="headerlink" title="畅想"></a>畅想</h2><p>  有感于macvim不想接入neovim做为后端<a href="https://github.com/macvim-dev/macvim/issues/47" target="_blank" rel="noopener">NeoVim</a>,平时工作当中使用macvim较多,又想使用nvim替代vim.这里只是做一下畅想,<code>macvim + neovim = macnvim</code></p>
<h2 id="相关源代码工程"><a href="#相关源代码工程" class="headerlink" title="相关源代码工程"></a>相关源代码工程</h2><p> <a href="https://github.com/vim/vim" target="_blank" rel="noopener">vim</a><br> <a href="https://github.com/macvim-dev/macvim" target="_blank" rel="noopener">macvim</a><br> <a href="https://github.com/neovim/neovim" target="_blank" rel="noopener">neovim</a><br> <a href="https://github.com/rogual/neovim-dot-app" target="_blank" rel="noopener">neovim-dot-app</a></p>
<h2 id="neovim的工作方式"><a href="#neovim的工作方式" class="headerlink" title="neovim的工作方式"></a>neovim的工作方式</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Neovim ------&gt; GUI 1 (attach/detach to running instance)</span><br><span class="line">  |  |</span><br><span class="line">  |   `------&gt; GUI 2 (communicating on a different socket or transport</span><br><span class="line">  |                   mechanism, but sharing the same session with GUI 1)</span><br><span class="line">   `--&gt; Plugin 1</span><br><span class="line">  |</span><br><span class="line">   `--&gt; Plugin 2</span><br><span class="line">  |</span><br><span class="line">   `--&gt; Plugin 3</span><br></pre></td></tr></table></figure>
<p>   neovim使用rpc方式使数据层与ui的显示层解耦,类似于x服务,核心的功能尽量小而全,与ui相关的交互通过事件或者消息的方式通知</p>
<h2 id="macvim的工作方式"><a href="#macvim的工作方式" class="headerlink" title="macvim的工作方式"></a>macvim的工作方式</h2><p>   引用macvim文档当中的话</p>
<blockquote>
<p>Each editor window in MacVim runs its own Vim process (but there is always<br>only one MacVim process).  Communication between MacVim and a Vim process is<br>done using Distributed Objects (DO).  Each Vim process is represented by a<br>backend object (MMBackend) and it communicates with the frontend object in the<br>Vim process (MMAppController).  The interface between the backend and frontend<br>is defined in MacVim.h.</p>
<p>The frontend sends input to the backend by calling<br>-[MMBackend processInput:data:].  The backend queues output on a command queue<br>and sends it to the frontend at opportune times by calling<br>-[MMAppController processInput:forIdentifier:].  These are both asynchronous<br>calls so MacVim can keep drawing and receiving input while Vim is working away,<br>thus always keeping the user interface responsive.</p>
<p>The state of each editor window is kept entirely in the Vim process.  MacVim<br>should remain “ignorant” in the sense that it knows nothing of the actual<br>state of a Vim process.  Typically this is not a problem, but sometimes MacVim<br>must change state without going via Vim, and sometimes MacVim needs immediate<br>access to the state from Vim.  The former happens e.g. when the user drags to<br>resize a window (MacVim changes the window dimensions immediately withoutn<br>asking Vim first), the second can happen when some option variable affects the<br>way something is presented visually (e.g. MacVim needs immediate access to the<br>‘mousehide’ option so that it can hide the mouse cursor when input is<br>received).  State information that may be required in this way can be “pushed”<br>to MacVim inside -[MMBackend queueVimStateMessage].<br>Vim:</p>
<p>Hooks from within Vim are implemented in gui_macvim.m, the name of such<br>functions usually start with “gui_mch_” and they should simply put a message<br>on the output queue, by calling queueMessage:properties: on the singleton<br>MMBackend object [MMBackend sharedInstance] (see e.g. gui_mch_destroy_menu()).<br>The output queue is flushed when requested (in -[MMBackend flushQueue]) or<br>before Vim takes a nap whilst waiting for new input (in<br>-[MMBackend waitForInput]).</p>
</blockquote>
<p>通过以上可知,macvim的实现方式也是将ui的相关操作通过事件或者消息来通知主界面原生的ui做相应的处理,这与neovim现有的框架设计是不谋而合,只是macvim定义的各种事件与neovim定义的各种事件有不一样的地方.</p>
<h2 id="关于neovim-dot-app"><a href="#关于neovim-dot-app" class="headerlink" title="关于neovim-dot-app"></a>关于neovim-dot-app</h2><p>   neovim-dot-app的实现方式,先通过fork的方式运行nvim做为后端进程,然后使用stdin做为管道用于主界面与后端neovim之间的通信.相对于macvim的代码量,就几个简单类,所以实现的功能也比较有限.</p>
<h2 id="畅想-1"><a href="#畅想-1" class="headerlink" title="畅想"></a>畅想</h2><p>   通过几个工程的源代码分析,可以看前后端都是基于rpc的方式来通信,因此有以下的二种方案</p>
<ol>
<li>将macvim的MMBackend移植到neovim,理论上可以不修改macvim就支持neovim(^_^),但这样就破坏了neovim的规范,也合macvim与特定的neovim绑定在一起,只能使用自已的版本.</li>
<li>调整macvim的<code>NSConnection</code>通信方式,使用socket/stdin来通信,并且要适配好neovim的协议到macvim本身的协议,这样的实现与后面neovim解耦,可以各自演化以达到neovim的设计初衷.</li>
</ol>
<h2 id="梦醒"><a href="#梦醒" class="headerlink" title="梦醒"></a>梦醒</h2><p>   个人倾向于使用第二种方案来实现,无奈oc水平有限,就些作罢..这里只提供思路,期待后期有志之士实现了(<em>_</em>)</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/28/bgfx/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yu Bin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="未来视">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/03/28/bgfx/" class="post-title-link" itemprop="url">bgfx</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-03-28 20:45:02" itemprop="dateCreated datePublished" datetime="2019-03-28T20:45:02+08:00">2019-03-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-03-29 08:49:47" itemprop="dateModified" datetime="2019-03-29T08:49:47+08:00">2019-03-29</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/bgfx/" itemprop="url" rel="index"><span itemprop="name">bgfx</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h2><ul>
<li>多后端,多平台支持</li>
<li>多线程并行渲染(基于command buffer)</li>
<li>渲染状态batch的渲染器</li>
</ul>
<h2 id="并行渲染实现"><a href="#并行渲染实现" class="headerlink" title="并行渲染实现"></a>并行渲染实现</h2><ol>
<li>命令的序列化<br>逻辑线程将调用序列化并存储后交由渲染线程执行</li>
<li>资源handle化<br>由于调用并不能立即得到结果，只能以返回句柄的方式给应用层，引擎要处理好句柄与真正资源之间的转化。应用层只使用handle,渲染线程在真正使用时将handle转化为真正的资源</li>
</ol>
<h2 id="结构解析"><a href="#结构解析" class="headerlink" title="结构解析"></a>结构解析</h2><h3 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h3><p>渲染引擎的上下文,对外接口总入口<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">//渲染一帧</span><br><span class="line">BGFX_API_FUNC(uint32_t frame(bool _capture = false) );</span><br><span class="line">//渲染线程的入口</span><br><span class="line">RenderFrame::Enum renderFrame(int32_t _msecs = -1);</span><br><span class="line">//逻辑线程与渲染线程的同步</span><br><span class="line">// Render thread shutdown sequence.</span><br><span class="line">encoderApiWait();</span><br><span class="line">renderSemWait(); // Wait for previous frame.</span><br><span class="line">apiSemPost();   // OK to set context to NULL.</span><br><span class="line">// s_ctx is NULL here.</span><br><span class="line">renderSemWait(); // In RenderFrame::Exiting state.</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<h3 id="Frame"><a href="#Frame" class="headerlink" title="Frame"></a>Frame</h3><p>渲染线程的数据存储，开启多纯种时有二个结构<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">struct Context&#123;</span><br><span class="line">...</span><br><span class="line">Frame* m_render;//渲染线程使用--执行其中的命令</span><br><span class="line">Frame* m_submit;//逻辑线程使用--添加命令</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>swap的时候会将二个Frame内容交换<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">struct Frame&#123;</span><br><span class="line">...</span><br><span class="line">    CommandBuffer m_cmdPre; --命令组，渲染命令前</span><br><span class="line">    CommandBuffer m_cmdPost; --命令组，渲染命令后</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Views"><a href="#Views" class="headerlink" title="Views"></a>Views</h3><blockquote>
<p>View is primary sorting mechanism in bgfx. View represent bucket of draw and compute calls. Compute and draw calls inside bucket are sorted in the way that all compute calls are executed before draw calls. Compute calls are always in order of submission, while draw calls are sorted by internal state if view is not in sequential mode. In the most of cases when z-buffer is used this change in order is not noticable to desired output. In cases where order has to be preserved (for example in rendering GUIs), view can be set to be in sequential order. Sequential order is less efficient, because it doesn’t allow state change optimization, and should be avoided when possible.</p>
</blockquote>
<p>view可以用来管理一组命令</p>
<h3 id="Encoder-EncoderImpl"><a href="#Encoder-EncoderImpl" class="headerlink" title="Encoder(EncoderImpl)"></a>Encoder(EncoderImpl)</h3><blockquote>
<p>Encoders are used for submitting draw calls from multiple threads. Only one encoder per thread should be used. Use bgfx::begin() to obtain an encoder for a thread</p>
</blockquote>
<p>多个线程来增加执行命令，每个Encoder使用各自的UniformBuffer<br>接口中设置的渲染数据可以分为两类，一类是和View相关的如 setViewRect 之类的，这类会直接通过 Context 的成员函数进行设置，另一类是setUniform等和View无关的，这类会通过 Context 的 Encoder 间接调用对应的接口，而这些接口调用又通过一个定义的宏 BGFX_ENCODER 转接到 EncoderImpl 上去（在项目中经常看到这样类似的宏），而 EncoderImpl 中大多就是将这些参数写入一个个Buffer或者其内部数据成员中，最终在 renderer_gl.cpp 之类对应驱动的渲染器内部的 submit 等接口中，通过将数据存储在 Frame 里的 RenderItem 再里面的 RenderDraw 等一系列对象中，并在该接口内部完成绑定。<br>而 EncoderImpl 保存数据的 Frame 和 bgfx 传递给具体 Renderer（即 m_render ） 的 submit 的 Frame 是怎么同步的呢，这里其实在 Context::begin 的时候会调用 EncoderImpl::begin ，同时传入其 m_submit 成员，而该成员在非多线程的情况下与 m_render 是同一个对象，而至于在多线程情况下目前还没有研究到。</p>
<h3 id="CommandBuffer"><a href="#CommandBuffer" class="headerlink" title="CommandBuffer"></a>CommandBuffer</h3><p>bgfx 的顶点数据等信息的设置，都是先缓存在类似 RenderDraw 之类的对象中，RenderDraw 这些对象又缓存在对应的 Encoder 中，Encoder 又依附在 Context 上，最后渲染的时候将这些信息一个个commit批量使用gl命令来进行实际的执行操作，这样可以在这里做batch等优化操作。<br>这些渲染命令分为在渲染前执行和渲染后执行两种，统一由 CommandBuffer 来管理，bgfx 是在用户调用createXXXBuffer （如创建顶点数据Buffer）之类接口调用时，间接调用 Context 的 createXXXBuffer，其内部以 Buffer 的类型（在 CommandBuffer 中用枚举定义了各种命令类型）来判断是用前置命令还是后置命令（通过 getCommandBuffer 来获取），然后使用不同的 CommandBuffer（前置为 m_submit-&gt;m_cmdPre，后置为 m_submit-&gt;m_cmdPost ）来写入数据，接下来在renderFrame的时候再从这两个Buffer里读取此前写入的数据，并调用对应驱动如 renderer_gl.cpp 下的 RendererContextI 来设置数据。<br>CommandBuffer 主要用于创建 VertexBuffer、Shader等GL资源或者执行GL指令，而 Encoder 则用来记录各种参数如变换矩阵等等，在渲染前通过 Frame 带上这些数据绑定到着色器里对应的变量上。</p>
<h3 id="RendererContextI"><a href="#RendererContextI" class="headerlink" title="RendererContextI"></a>RendererContextI</h3><p>渲染接口的抽象类，每个后端实现都要实现这个接口的方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">//资源类管理命令 index,vertex,texture,shader,program,framebuffer,</span><br><span class="line">virtual void createXXX() = 0;</span><br><span class="line">virtual void updateXXX() = 0;</span><br><span class="line">virtual void destroyXXX() = 0;</span><br><span class="line">//重要接口，执行一个Frame当中的渲染命令</span><br><span class="line">void submit(Frame* _render, ClearQuad&amp; /*_clearQuad*/, TextVideoMemBlitter&amp; /*_textVideoMemBlitter*/) override</span><br><span class="line">//其他接口</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<h3 id="流程图"><a href="#流程图" class="headerlink" title="流程图"></a>流程图</h3><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1g13r3nq4s3j312v0u07f0.jpg" alt=""></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://zhuanlan.zhihu.com/p/59452545" target="_blank" rel="noopener">跨平台渲染引擎之路：bgfx分析</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/27/KlayGE/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yu Bin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="未来视">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/03/27/KlayGE/" class="post-title-link" itemprop="url">KlayGE</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-03-27 22:21:17" itemprop="dateCreated datePublished" datetime="2019-03-27T22:21:17+08:00">2019-03-27</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-03-28 08:59:25" itemprop="dateModified" datetime="2019-03-28T08:59:25+08:00">2019-03-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/KlayGE/" itemprop="url" rel="index"><span itemprop="name">KlayGE</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>游戏引擎 vs 图形渲染库</p>
<p>图形渲染是游戏引擎的基础部件，好比大厦的地基。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/27/unity-shader-examples/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yu Bin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="未来视">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/03/27/unity-shader-examples/" class="post-title-link" itemprop="url">unity-shader-examples</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-03-27 16:47:28 / Modified: 17:53:46" itemprop="dateCreated datePublished" datetime="2019-03-27T16:47:28+08:00">2019-03-27</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/unity/" itemprop="url" rel="index"><span itemprop="name">unity</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-Bump纹理"><a href="#1-Bump纹理" class="headerlink" title="1.Bump纹理"></a>1.Bump纹理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">Shader &quot;Custom/S_Bump&quot; &#123;</span><br><span class="line">    Properties &#123;</span><br><span class="line">        _MainTex (&quot;Texture&quot;, 2D) = &quot;white&quot; &#123;&#125;</span><br><span class="line">        _BumpMap (&quot;Bump&quot;, 2D) = &quot;bump&quot; &#123;&#125;</span><br><span class="line">        _RimColor (&quot;Rim Color&quot;,Color) = (0.17,0.36,0.81,0.0)</span><br><span class="line">        _RimPower (&quot;Rim Power&quot;, Range(0.6,9.0)) = 1.0</span><br><span class="line">    &#125;</span><br><span class="line">    SubShader &#123;</span><br><span class="line">        Tags &#123; &quot;RenderType&quot;=&quot;Opaque&quot; &#125;</span><br><span class="line">        LOD 200</span><br><span class="line"></span><br><span class="line">        CGPROGRAM</span><br><span class="line">        // Physically based Standard lighting model, and enable shadows on all light types</span><br><span class="line">        #pragma surface surf Standard fullforwardshadows</span><br><span class="line"></span><br><span class="line">        // Use shader model 3.0 target, to get nicer looking lighting</span><br><span class="line">        #pragma target 3.0</span><br><span class="line"></span><br><span class="line">        sampler2D _MainTex;</span><br><span class="line">        sampler2D _BumpMap;</span><br><span class="line">        float4 _RimColor;</span><br><span class="line">        float _RimPower;</span><br><span class="line"></span><br><span class="line">        struct Input &#123;</span><br><span class="line">            float2 uv_MainTex;</span><br><span class="line">            float2 uv_BumpMap;</span><br><span class="line">            float3 viewDir;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        void surf (Input IN, inout SurfaceOutputStandard o) &#123;</span><br><span class="line">            // Albedo comes from a texture tinted by color</span><br><span class="line">            fixed4 c = tex2D (_MainTex, IN.uv_MainTex);</span><br><span class="line">            o.Albedo = c.rgb;</span><br><span class="line"></span><br><span class="line">            o.Normal = UnpackNormal(tex2D(_BumpMap,IN.uv_BumpMap));</span><br><span class="line"></span><br><span class="line">            half rim = 1.0 - saturate(dot(normalize(IN.viewDir),o.Normal));</span><br><span class="line"></span><br><span class="line">            o.Emission = _RimColor.rgb * pow(rim,_RimPower);</span><br><span class="line"></span><br><span class="line">            o.Alpha = c.a;</span><br><span class="line">        &#125;</span><br><span class="line">        ENDCG</span><br><span class="line">    &#125;</span><br><span class="line">    FallBack &quot;Diffuse&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-自定义光照"><a href="#2-自定义光照" class="headerlink" title="2.自定义光照"></a>2.自定义光照</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">Shader &quot;S_Light&quot; </span><br><span class="line">&#123;  </span><br><span class="line">    //--------------------------------【属性】---------------------------------------- </span><br><span class="line">    Properties   </span><br><span class="line">    &#123;  </span><br><span class="line">        _MainTex (&quot;【主纹理】Texture&quot;, 2D) = &quot;white&quot; &#123;&#125;  </span><br><span class="line">        _Ramp (&quot;【渐变纹理】Ramp Texture&quot;, 2D) = &quot;white&quot;&#123;&#125;  </span><br><span class="line">        _BumpMap (&quot;【凹凸纹理】Bumpmap&quot;, 2D) = &quot;bump&quot; &#123;&#125;  </span><br><span class="line">        _Detail (&quot;【细节纹理】Detail&quot;, 2D) = &quot;gray&quot; &#123;&#125;  </span><br><span class="line">        _RimColor (&quot;【边缘颜色】Rim Color&quot;, Color) = (0.26,0.19,0.16,0.0)  </span><br><span class="line">        _RimPower (&quot;【边缘颜色强度】Rim Power&quot;, Range(0.5,8.0)) = 3.0  </span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line">    //--------------------------------【子着色器】----------------------------------</span><br><span class="line">    SubShader </span><br><span class="line">    &#123;  </span><br><span class="line">        //-----------子着色器标签----------  </span><br><span class="line">        Tags &#123; &quot;RenderType&quot;=&quot;Opaque&quot; &#125;  </span><br><span class="line">        LOD 200  </span><br><span class="line"></span><br><span class="line">        //-------------------开始CG着色器编程语言段-----------------  </span><br><span class="line">        CGPROGRAM  </span><br><span class="line"></span><br><span class="line">        //【1】光照模式声明：使用自制的卡通渐变光照模式 + 自定义颜色函数--注意名字要与下文的对上</span><br><span class="line">        #pragma surface surf QianMoCartoonShader finalcolor:setcolor</span><br><span class="line"></span><br><span class="line">        //变量声明  </span><br><span class="line">        sampler2D _MainTex;  </span><br><span class="line">        sampler2D _Ramp;  </span><br><span class="line">        sampler2D _BumpMap;  </span><br><span class="line">        sampler2D _Detail;  </span><br><span class="line">        float4 _RimColor;  </span><br><span class="line">        float _RimPower;  </span><br><span class="line"></span><br><span class="line">        //【2】实现自制的卡通渐变光照模式--名字要与上文中对上</span><br><span class="line">        inline float4 LightingQianMoCartoonShader(SurfaceOutput s, fixed3 lightDir, fixed atten)  </span><br><span class="line">        &#123;  </span><br><span class="line">            //点乘反射光线法线和光线方向</span><br><span class="line">            half NdotL = dot (s.Normal, lightDir); </span><br><span class="line">            //增强光强</span><br><span class="line">            half diff = NdotL * 0.5 + 0.5;</span><br><span class="line">            //从纹理中定义渐变效果</span><br><span class="line">            half3 ramp = tex2D (_Ramp, float2(diff,diff)).rgb;</span><br><span class="line">            //计算出最终结果</span><br><span class="line">            half4 color;</span><br><span class="line">            color.rgb = s.Albedo * _LightColor0.rgb * ramp * (atten * 2);</span><br><span class="line">            color.a = s.Alpha;</span><br><span class="line"></span><br><span class="line">            return color;</span><br><span class="line">        &#125;  </span><br><span class="line"></span><br><span class="line">        //【3】自定义颜色函数setcolor的编写</span><br><span class="line">        void setcolor (Input IN, SurfaceOutput o, inout fixed4 color)</span><br><span class="line">        &#123;</span><br><span class="line">            color *= _ColorTint;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        //【4】输入结构    </span><br><span class="line">        struct Input   </span><br><span class="line">        &#123;  </span><br><span class="line">            //主纹理的uv值  </span><br><span class="line">            float2 uv_MainTex;  </span><br><span class="line">            //凹凸纹理的uv值  </span><br><span class="line">            float2 uv_BumpMap;  </span><br><span class="line">            //细节纹理的uv值  </span><br><span class="line">            float2 uv_Detail;   </span><br><span class="line">            //当前坐标的视角方向  </span><br><span class="line">            float3 viewDir;  </span><br><span class="line">        &#125;;  </span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        //【5】表面着色函数的编写</span><br><span class="line">        void surf (Input IN, inout SurfaceOutput o)  </span><br><span class="line">        &#123;  </span><br><span class="line">             //先从主纹理获取rgb颜色值  </span><br><span class="line">            o.Albedo = tex2D (_MainTex, IN.uv_MainTex).rgb;     </span><br><span class="line">            //设置细节纹理  </span><br><span class="line">            o.Albedo *= tex2D (_Detail, IN.uv_Detail).rgb * 2;   </span><br><span class="line">            //从凹凸纹理获取法线值  </span><br><span class="line">            o.Normal = UnpackNormal (tex2D (_BumpMap, IN.uv_BumpMap));  </span><br><span class="line">            //从_RimColor参数获取自发光颜色  </span><br><span class="line">            half rim = 1.0 - saturate(dot (normalize(IN.viewDir), o.Normal));  </span><br><span class="line">            o.Emission = _RimColor.rgb * pow (rim, _RimPower);  </span><br><span class="line"></span><br><span class="line">        &#125;  </span><br><span class="line"></span><br><span class="line">        //-------------------结束CG着色器编程语言段------------------</span><br><span class="line">        ENDCG  </span><br><span class="line">    &#125;   </span><br><span class="line">    FallBack &quot;Diffuse&quot;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://docs.unity3d.com/Manual/SL-SurfaceShaders.html" target="_blank" rel="noopener">Unity3D</a><br><a href="https://github.com/QianMo/Awesome-Unity-Shader" target="_blank" rel="noopener">关于炫酷的Unity3D Shader</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/26/unity-shader/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yu Bin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="未来视">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/03/26/unity-shader/" class="post-title-link" itemprop="url">unity-shader</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-03-26 10:04:02" itemprop="dateCreated datePublished" datetime="2019-03-26T10:04:02+08:00">2019-03-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-03-27 17:38:35" itemprop="dateModified" datetime="2019-03-27T17:38:35+08:00">2019-03-27</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/unity/" itemprop="url" rel="index"><span itemprop="name">unity</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="固定管线示例示例1"><a href="#固定管线示例示例1" class="headerlink" title="固定管线示例示例1"></a>固定管线示例<a href="https://docs.unity3d.com/Manual/ShaderTut1.html" target="_blank" rel="noopener">示例1</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Shader &quot;Tutorial/Basic&quot; &#123;</span><br><span class="line">    Properties &#123;</span><br><span class="line">        _Color (&quot;Main Color&quot;, Color) = (1,0.5,0.5,1)</span><br><span class="line">    &#125;</span><br><span class="line">    SubShader &#123;</span><br><span class="line">        Pass &#123;</span><br><span class="line">            Material &#123;</span><br><span class="line">                Diffuse [_Color]</span><br><span class="line">            &#125;</span><br><span class="line">            Lighting On</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="可编程管线示例示例2"><a href="#可编程管线示例示例2" class="headerlink" title="可编程管线示例示例2"></a>可编程管线示例<a href="https://docs.unity3d.com/Manual/ShaderTut2.html" target="_blank" rel="noopener">示例2</a></h3><ul>
<li><a href="https://docs.unity3d.com/Manual/SL-VertexFragmentShaderExamples.html" target="_blank" rel="noopener">vertex and fragment shader</a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Shader &quot;MyShaderName&quot;</span><br><span class="line">&#123;</span><br><span class="line">    Properties</span><br><span class="line">    &#123;</span><br><span class="line">        // material properties here</span><br><span class="line">    &#125;</span><br><span class="line">    SubShader // subshader for graphics hardware A</span><br><span class="line">    &#123;</span><br><span class="line">        Pass</span><br><span class="line">        &#123;</span><br><span class="line">            // pass commands ...</span><br><span class="line">        &#125;</span><br><span class="line">        // more passes if needed</span><br><span class="line">    &#125;</span><br><span class="line">    // more subshaders if needed</span><br><span class="line">    FallBack &quot;VertexLit&quot; // optional fallback</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="表面Shaders示例3"><a href="#表面Shaders示例3" class="headerlink" title="表面Shaders示例3"></a>表面Shaders<a href="https://docs.unity3d.com/Manual/SL-SurfaceShaderExamples.html" target="_blank" rel="noopener">示例3</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Shader &quot;Example/Diffuse Simple&quot; &#123;</span><br><span class="line">  SubShader &#123;</span><br><span class="line">    Tags &#123; &quot;RenderType&quot; = &quot;Opaque&quot; &#125;</span><br><span class="line">    CGPROGRAM</span><br><span class="line">    #pragma surface surf Lambert</span><br><span class="line">    struct Input &#123;</span><br><span class="line">        float4 color : COLOR;</span><br><span class="line">    &#125;;</span><br><span class="line">    void surf (Input IN, inout SurfaceOutput o) &#123;</span><br><span class="line">        o.Albedo = 1;</span><br><span class="line">    &#125;</span><br><span class="line">    ENDCG</span><br><span class="line">  &#125;</span><br><span class="line">  Fallback &quot;Diffuse&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://docs.unity3d.com/Manual/SL-SurfaceShaders.html" target="_blank" rel="noopener">Unity3D</a><br><a href="https://onevcat.com/2013/07/shader-tutorial-1/" target="_blank" rel="noopener">猫都能学会的Unity3D Shader入门指南（一）</a><br><a href="https://onevcat.com/2013/08/shader-tutorial-2/" target="_blank" rel="noopener">猫都能学会的Unity3D Shader入门指南（二）</a><br><a href="https://en.wikibooks.org/wiki/Cg_Programming/Unity" target="_blank" rel="noopener">Cg Programming/Unity</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/13/人生果实/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yu Bin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="未来视">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/03/13/人生果实/" class="post-title-link" itemprop="url">人生果实</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-03-13 23:01:16" itemprop="dateCreated datePublished" datetime="2019-03-13T23:01:16+08:00">2019-03-13</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-03-14 12:06:09" itemprop="dateModified" datetime="2019-03-14T12:06:09+08:00">2019-03-14</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/感悟生活/" itemprop="url" rel="index"><span itemprop="name">感悟生活</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>风吹枯叶落，落叶生肥土。肥土丰香果，孜孜不倦，不紧不慢……人生也如这般……</p>
</blockquote>
<p>   我们终其一生一直在探索我是谁，我想要过什么样的生活，什么样的人生是想要活成的模样？我还在找思索中，你是否找到了答案了呢？</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/13/lua类机制/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yu Bin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="未来视">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/03/13/lua类机制/" class="post-title-link" itemprop="url">lua类机制</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-03-13 09:01:53 / Modified: 09:12:42" itemprop="dateCreated datePublished" datetime="2019-03-13T09:01:53+08:00">2019-03-13</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/lua/" itemprop="url" rel="index"><span itemprop="name">lua</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="lua类机制的简易实现"><a href="#lua类机制的简易实现" class="headerlink" title="lua类机制的简易实现"></a>lua类机制的简易实现</h2><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> _class=&#123;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">class</span><span class="params">(super)</span></span></span><br><span class="line">	<span class="keyword">local</span> class_type=&#123;&#125;</span><br><span class="line">	class_type.ctor=<span class="literal">false</span></span><br><span class="line">	class_type.super=super</span><br><span class="line">	class_type.new=<span class="function"><span class="keyword">function</span><span class="params">(...)</span></span> </span><br><span class="line">			<span class="keyword">local</span> obj=&#123;&#125;</span><br><span class="line">			<span class="keyword">do</span></span><br><span class="line">				<span class="keyword">local</span> <span class="built_in">create</span></span><br><span class="line">				<span class="built_in">create</span> = <span class="function"><span class="keyword">function</span><span class="params">(c,...)</span></span></span><br><span class="line">					<span class="keyword">if</span> c.super <span class="keyword">then</span></span><br><span class="line">						<span class="built_in">create</span>(c.super,...)</span><br><span class="line">					<span class="keyword">end</span></span><br><span class="line">					<span class="keyword">if</span> c.ctor <span class="keyword">then</span></span><br><span class="line">						c.ctor(obj,...)</span><br><span class="line">					<span class="keyword">end</span></span><br><span class="line">				<span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line">				<span class="built_in">create</span>(class_type,...)</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">			<span class="built_in">setmetatable</span>(obj,&#123; <span class="built_in">__index</span>=_class[class_type] &#125;)</span><br><span class="line">			<span class="keyword">return</span> obj</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">	<span class="keyword">local</span> vtbl=&#123;&#125;</span><br><span class="line">	_class[class_type]=vtbl</span><br><span class="line"> </span><br><span class="line">	<span class="built_in">setmetatable</span>(class_type,&#123;<span class="built_in">__newindex</span>=</span><br><span class="line">		<span class="function"><span class="keyword">function</span><span class="params">(t,k,v)</span></span></span><br><span class="line">			vtbl[k]=v</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">	&#125;)</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">if</span> super <span class="keyword">then</span></span><br><span class="line">		<span class="built_in">setmetatable</span>(vtbl,&#123;<span class="built_in">__index</span>=</span><br><span class="line">			<span class="function"><span class="keyword">function</span><span class="params">(t,k)</span></span></span><br><span class="line">				<span class="keyword">local</span> ret=_class[super][k]</span><br><span class="line">				vtbl[k]=ret</span><br><span class="line">				<span class="keyword">return</span> ret</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">		&#125;)</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line">	<span class="keyword">return</span> class_type</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">base_type=class()		<span class="comment">-- 定义一个基类 base_type</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">base_type:ctor</span><span class="params">(x)</span></span>	<span class="comment">-- 定义 base_type 的构造函数</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"base_type ctor"</span>)</span><br><span class="line">	self.x=x</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">base_type:print_x</span><span class="params">()</span></span>	<span class="comment">-- 定义一个成员函数 base_type:print_x</span></span><br><span class="line">	<span class="built_in">print</span>(self.x)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">base_type:hello</span><span class="params">()</span></span>	<span class="comment">-- 定义另一个成员函数 base_type:hello</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"hello base_type"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">test=class(base_type)	<span class="comment">-- 定义一个类 test 继承于 base_type</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test:ctor</span><span class="params">()</span></span>	<span class="comment">-- 定义 test 的构造函数</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"test ctor"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test:hello</span><span class="params">()</span></span>	<span class="comment">-- 重载 base_type:hello 为 test:hello</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"hello test"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a=test.new(<span class="number">1</span>)	<span class="comment">-- 输出两行，base_type ctor 和 test ctor 。这个对象被正确的构造了。</span></span><br><span class="line">a:print_x()	<span class="comment">-- 输出 1 ，这个是基类 base_type 中的成员函数。</span></span><br><span class="line">a:hello()	<span class="comment">-- 输出 hello test ，这个函数被重载了。</span></span><br></pre></td></tr></table></figure>
<h2 id="lua类机制的简易实现–多重继承"><a href="#lua类机制的简易实现–多重继承" class="headerlink" title="lua类机制的简易实现–多重继承"></a>lua类机制的简易实现–多重继承</h2><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">search</span><span class="params">(classes, key)</span></span></span><br><span class="line">    <span class="keyword">for</span> i = <span class="number">1</span>, #classes <span class="keyword">do</span></span><br><span class="line">        <span class="keyword">local</span> value = classes[i][key];</span><br><span class="line">        <span class="keyword">if</span> value ~= <span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">class</span><span class="params">(fun,...)</span></span></span><br><span class="line">    <span class="keyword">local</span> class_type=&#123;&#125;</span><br><span class="line">    class_type.ctor=<span class="literal">false</span></span><br><span class="line">    <span class="keyword">local</span> parents = &#123;...&#125;</span><br><span class="line">    <span class="keyword">if</span> #parents  &gt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">        class_type.super=parents</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        class_type.super=<span class="literal">nil</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    class_type.fun = fun</span><br><span class="line">    class_type.new=<span class="function"><span class="keyword">function</span><span class="params">(...)</span></span></span><br><span class="line">        <span class="keyword">local</span> obj</span><br><span class="line">        <span class="keyword">if</span> class_type.fun <span class="keyword">then</span></span><br><span class="line">            obj = class_type.fun(...)</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            obj = &#123;&#125;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">            <span class="keyword">local</span> <span class="built_in">create</span></span><br><span class="line">            <span class="built_in">create</span> = <span class="function"><span class="keyword">function</span><span class="params">(c,...)</span></span></span><br><span class="line">                <span class="keyword">if</span> c.super <span class="keyword">then</span></span><br><span class="line">                    <span class="keyword">for</span> i = <span class="number">1</span>, #c.super <span class="keyword">do</span></span><br><span class="line">                        <span class="built_in">create</span>(c.super[i],...)</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">if</span> c.ctor <span class="keyword">then</span></span><br><span class="line">                    c.ctor(obj,...)</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">            <span class="built_in">create</span>(class_type,...)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="built_in">setmetatable</span>(obj,&#123; <span class="built_in">__index</span>=class_type &#125;)</span><br><span class="line">        <span class="keyword">return</span> obj</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> class_type.super <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">setmetatable</span>(class_type,&#123;<span class="built_in">__index</span>=</span><br><span class="line">                <span class="function"><span class="keyword">function</span><span class="params">(t,k)</span></span></span><br><span class="line">                    <span class="keyword">local</span> ret=search(class_type.super,k)</span><br><span class="line">                    class_type[k]=ret</span><br><span class="line">                    <span class="keyword">return</span> ret</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            &#125;)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> class_type</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> base_type=class()		<span class="comment">-- 定义一个基类 base_type</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">base_type:ctor</span><span class="params">(x)</span></span>	<span class="comment">-- 定义 base_type 的构造函数</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"base_type ctor"</span>)</span><br><span class="line">    self.x=x</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">base_type:print_x</span><span class="params">()</span></span>	<span class="comment">-- 定义一个成员函数 base_type:print_x</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"print base_type"</span>)</span><br><span class="line">    <span class="built_in">print</span>(self.x)</span><br><span class="line">    self:print_b()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">base_type:hello</span><span class="params">()</span></span>	<span class="comment">-- 定义另一个成员函数 base_type:hello</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"hello base_type"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> base_typeB=class()		<span class="comment">-- 定义一个基类 base_type</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">base_typeB:ctor</span><span class="params">(x)</span></span>	<span class="comment">-- 定义 base_type 的构造函数</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"base_typeB ctor"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">base_typeB:print_b</span><span class="params">()</span></span>	<span class="comment">-- 定义一个成员函数 base_type:print_x</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"print base_typeB"</span>)</span><br><span class="line">    <span class="built_in">print</span>(self.x)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">base_typeB:helloB</span><span class="params">()</span></span>	<span class="comment">-- 定义另一个成员函数 base_type:hello</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"hello base_typeB"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> test=class(<span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"fun"</span>)</span><br><span class="line">    <span class="keyword">return</span> &#123;&#125;</span><br><span class="line"><span class="keyword">end</span>,</span><br><span class="line">base_typeB,base_type)	<span class="comment">-- 定义一个类 test 继承于 base_type</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test:ctor</span><span class="params">()</span></span>	<span class="comment">-- 定义 test 的构造函数</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"test ctor"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test:hello</span><span class="params">()</span></span>	<span class="comment">-- 重载 base_type:hello 为 test:hello</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"hello test"</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> a=test.new(<span class="number">1</span>)	<span class="comment">-- 输出两行，base_type ctor 和 test ctor 。这个对象被正确的构造了。</span></span><br><span class="line">a:print_x()	<span class="comment">-- 输出 1 ，这个是基类 base_type 中的成员函数。</span></span><br><span class="line">a:hello()	<span class="comment">-- 输出 hello test ，这个函数被重载了。</span></span><br><span class="line">a:helloB()</span><br></pre></td></tr></table></figure>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://blog.codingnow.com/cloud/LuaOO" target="_blank" rel="noopener">Lua 中实现面向对象</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/10/markdown语法/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yu Bin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="未来视">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/03/10/markdown语法/" class="post-title-link" itemprop="url">markdown语法</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-03-10 23:18:39" itemprop="dateCreated datePublished" datetime="2019-03-10T23:18:39+08:00">2019-03-10</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-03-11 15:15:49" itemprop="dateModified" datetime="2019-03-11T15:15:49+08:00">2019-03-11</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/markdown/" itemprop="url" rel="index"><span itemprop="name">markdown</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><p>Markdown语法主要分为如下几大部分：<br><strong>标题</strong>，<strong>段落</strong>，<strong>区块引用</strong>，<strong>代码区块</strong>，<strong>强调</strong>，<strong>列表</strong>，<strong>分割线</strong>，<strong>链接</strong>，<strong>图片</strong>，<strong>反斜杠 <code>\</code></strong>，<strong>符号<code>`</code></strong>。</p>
<p>使用<code>#</code>，可表示1-6级标题。</p>
<blockquote>
<p># 一级标题<br>## 二级标题<br>### 三级标题<br>#### 四级标题<br>##### 五级标题<br>###### 六级标题</p>
</blockquote>
<p>效果：</p>
<blockquote>
<h1 id="一级标题"><a href="#一级标题" class="headerlink" title="一级标题"></a>一级标题</h1><h2 id="二级标题"><a href="#二级标题" class="headerlink" title="二级标题"></a>二级标题</h2><h3 id="三级标题"><a href="#三级标题" class="headerlink" title="三级标题"></a>三级标题</h3><h4 id="四级标题"><a href="#四级标题" class="headerlink" title="四级标题"></a>四级标题</h4><h5 id="五级标题"><a href="#五级标题" class="headerlink" title="五级标题"></a>五级标题</h5><h6 id="六级标题"><a href="#六级标题" class="headerlink" title="六级标题"></a>六级标题</h6></blockquote>
<h4 id="段落"><a href="#段落" class="headerlink" title="段落"></a>段落</h4><p>段落的前后要有空行，所谓的空行是指没有文字内容。若想在段内强制换行的方式是使用<strong>两个以上</strong>空格加上回车（引用中换行省略回车）。</p>
<h4 id="区块引用"><a href="#区块引用" class="headerlink" title="区块引用"></a>区块引用</h4><p>在段落的每行或者只在第一行使用符号<code>&gt;</code>,还可使用多个嵌套引用，如：</p>
<blockquote>
<p>> 区块引用<br>>&gt; 嵌套引用</p>
</blockquote>
<p>效果：</p>
<blockquote>
<p>区块引用</p>
<blockquote>
<p>嵌套引用</p>
</blockquote>
</blockquote>
<h4 id="代码区块"><a href="#代码区块" class="headerlink" title="代码区块"></a>代码区块</h4><p>代码区块的建立是在每行加上4个空格或者一个制表符（如同写代码一样）。如<br>普通段落：</p>
<p>void main()<br>{<br>    printf(“Hello, Markdown.”);<br>}</p>
<p>代码区块：</p>
<pre><code>void main()
{
    printf(&quot;Hello, Markdown.&quot;);
}
</code></pre><p><strong>注意</strong>:需要和普通段落之间存在空行。</p>
<h4 id="强调"><a href="#强调" class="headerlink" title="强调"></a>强调</h4><p>在强调内容两侧分别加上<code>*</code>或者<code>_</code>，如：</p>
<blockquote>
<p>*斜体*，_斜体_<br>**粗体**，__粗体__</p>
</blockquote>
<p>效果：</p>
<blockquote>
<p><em>斜体</em>，_斜体_<br><strong>粗体</strong>，<strong>粗体</strong></p>
</blockquote>
<h4 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h4><p>使用<code>·</code>、<code>+</code>、或<code>-</code>标记无序列表，如：</p>
<blockquote>
<p>-（+*） 第一项<br>-（+*） 第二项<br>- （+*）第三项</p>
</blockquote>
<p><strong>注意</strong>：标记后面最少有一个_空格_或<em>制表符</em>。若不在引用区块中，必须和前方段落之间存在空行。</p>
<p>效果：</p>
<blockquote>
<ul>
<li>第一项</li>
<li>第二项</li>
<li>第三项</li>
</ul>
</blockquote>
<p>有序列表的标记方式是将上述的符号换成数字,并辅以<code>.</code>，如：</p>
<blockquote>
<p>1 . 第一项<br>2 . 第二项<br>3 . 第三项</p>
</blockquote>
<p>效果：</p>
<blockquote>
<ol>
<li>第一项</li>
<li>第二项</li>
<li>第三项</li>
</ol>
</blockquote>
<h4 id="分割线"><a href="#分割线" class="headerlink" title="分割线"></a>分割线</h4><p>分割线最常使用就是三个或以上<code>*</code>，还可以使用<code>-</code>和<code>_</code>。</p>
<h4 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h4><p>链接可以由两种形式生成：<strong>行内式</strong>和<strong>参考式</strong>。<br><strong>行内式</strong>：<br>[google](<a href="https://www.google.com" target="_blank" rel="noopener">https://www.google.com</a> )</p>
<p>效果：<br><a href="https:://www.google.com" target="_blank" rel="noopener">google</a></p>
<p><strong>参考式</strong>：<br>[google1][1]<br>[1]:https:://<a href="http://www.google.com" target="_blank" rel="noopener">www.google.com</a></p>
<p>效果：<br><a href="https:://www.google.com" target="_blank" rel="noopener">google1</a></p>
<p><strong>注意</strong>：上述的<code>[1]:https:://www.google.com</code>不出现在区块中。</p>
<h4 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h4><p>添加图片的形式和链接相似，只需在链接的基础上前方加一个<code>！</code>。</p>
<h4 id="0-反斜杠"><a href="#0-反斜杠" class="headerlink" title="0 反斜杠\"></a>0 反斜杠<code>\</code></h4><p>相当于<strong>反转义</strong>作用。使符号成为普通符号。</p>
<h4 id="1-符号’-’"><a href="#1-符号’-’" class="headerlink" title="1 符号’`’"></a>1 符号’`’</h4><p>起到标记作用。如：</p>
<blockquote>
<p>`ctrl+a`</p>
</blockquote>
<p>效果：</p>
<blockquote>
<p><code>ctrl+a</code></p>
</blockquote>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="https:://github.com/younghz/Markdown" target="_blank" rel="noopener">younghz的Markdown库</a></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Yu Bin</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">16</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">12</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">26</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yu Bin</span>

  

  
</div>









        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=6.7.0"></script>

  <script src="/js/src/motion.js?v=6.7.0"></script>



  
  


  <script src="/js/src/affix.js?v=6.7.0"></script>

  <script src="/js/src/schemes/pisces.js?v=6.7.0"></script>




  

  


  <script src="/js/src/bootstrap.js?v=6.7.0"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->



  




  





  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
